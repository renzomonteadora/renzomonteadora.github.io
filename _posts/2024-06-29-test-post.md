---
title: TEST POST
date: 2024-06-29 00:00:00 +0800
categories: [CISCO, CCNP]
tags: [cisco, ccnp]     # TAG names should always be lowercase
---



<hr>

# Table of Contents
- [[#Packet Forwarding]]
	- [[#Network Device Communication]]
		- [[#OSI Model vs TCP/IP Model]]
		- [[#Layer-2 Forwarding]]
	- [[#Forwarding Architecture]]
- [[#Spanning-Tree Protocol (STP)]]
	- [[#STP Foundation]]
	- [[#802.1D STP Fundamentals]]
	- [[#802.1W RSTP Fundamentals]]
- [[#Multiple Spanning Tree (MST)]]
	- [[#MST Fundamentals (802.1S)]]
- [[#VLAN Trunks and EtherChannel Bundles]]
- [[#IP Routing Essentials]]
	- [[#Routing Protocol Overview]]
	- [[#Path Selection]]
	- [[#Static Routing]]
	- [[#Virtual Routing and Forwarding (VRF)]]
- [[#Enhanced Gateway Routing Protocol (EIGRP)]]
	- [[#EIGRP Fundamentals]]
	- [[#EIGRP Path Metric Calculation]]
- [[#Open Short Path First (OSPF)]]
	- [[#OSPF Fundamentals]]
	- [[#Advanced OSPF]]
- [[#Border Gateway Protocol (BGP)]]
	- [[#BGP Fundamentals]]
	- [[#BGP DeepDive]]
- [[#First Hop Redundancy Protocol (FHRP)]]
	- [[#Hot Standby Router Protocol (HSRP)]]
	- [[#Virtual Router Redundancy Protocol (VRRP)]]
	- [[#Gateway Load Balancing Protocol (GLBP)]]
- [[#Network Address Translation (NAT)]]
	- [[#NAT Terms Topology]]
	- [[#Types of NAT]]
- [[#Overlay Tunnels]]
	- [[#GRE Tunnel]]
	- [[#IPsec Tunnel]]
	- [[#Location ID Separation Protocol (LISP)]]
	- [[#Virtual Extensible Local Area Network (VXLAN)]]



<hr>

## Packet Forwarding
### Network Device Communication

#### OSI Model vs TCP/IP Model
![test](https://i.imgur.com/bvdMLX4.png)

.callout_tip


>![](https://i.imgur.com/PcmnW8e.png)

#### Layer-2 Forwarding
##### Types of MAC Address
![](https://i.imgur.com/9STfvpA.png)
- **Unicast MAC Address**
	`- when the last bit of the first octet is 0.`
- **Multicast MAC Address**
	`- when the last bit of the first octet is 1.`
- **Broadcast MAC Address**
	`- when all bits are 1 (FF-FF-FF-FF-FF-FF).`


##### Ethernet Frame Header (IEEE 802.3)
![](https://i.imgur.com/gWAjn3x.png)

>[!faq] Note
>**Maximum MTU or Data = 1500 Bytes**
>- this includes the Layer-3 Header and its payload.
>  
>**Content Address Memory (CAM)**
>- it is where MAC address table resides.

##### Collision Domain
![](https://i.imgur.com/6Orfi3f.png)

>[!faq] Note
>**CSMA/CD**
>- a method used to detect any collisions happened on a single collision domain.

##### Virtual LAN (VLAN)
	`- add 32 bits to the packet header.`
	`- it is based on IEEE 802.1Q protocol.`
![](https://i.imgur.com/gF6GlMg.png)
- **IEEE 802.1Q Field:**
	- Tag Protocol Identifier (TPID) `- 16-bit field is set to 0x8100 to identify the packet as an 802.1Q packet.`
	- Priority Code Point (PCP) `- CoS marking for QoS.`
	- Drop Eligible Indicator (DEI) `-  indicates whether the packet can be dropped when there is bandwidth contention.`
	- VLAN ID `- 12-bit field specifies the VLAN associated with a network packet.`


- **VLAN ID Range:**
	`- since it is 12-bits, the total number of VLANss it can create is up to 0-4094.`
	
|  VLAN-ID  |   Definition    |
| :-------: | :-------------: |
|     0     | 802.1P reserved |
|     1     |     default     |
|  2-1001   |   normal VLAN   |
| 1002-1005 |    reserved     |
| 1006-4094 |  extended VLAN  |


>[!faq] Note
>Since it is 12-bits, the total number of VLANs it can create is up to 0-4094.
>
>**Normal Range VLAN** 
>- are stored in **vlan.dat** file in which located in the **flash** memory.
>
>**Extended Range VLAN**
>- are saved in **running configuration** file.
#### Layer-3 Forwarding
##### Local Routing
- ARP
##### Packet Routing
- Static Route
- Default Route
- Dynamic Routing
![](https://i.imgur.com/iDnwC4M.png)

>[!faq] Note
>**Routing Information Base (RIB)**
>- it is where a routing table is being stored.



### Forwarding Architecture
#### Router Switching Mechanisms
- **Process Switching**
	`- also known as Software Switching or Slow Path.`
	`- it software based switching.`
	![](https://i.imgur.com/e4cHg8q.png)
- **Fast Switching**
	![](https://i.imgur.com/FwIyGC0.png)
- **Cisco Express Forwarding (CEF)**
	![](https://i.imgur.com/Lvxe3YH.png)

#### Cisco Express Forwarding (CEF)
- **Software CEF**
	- Components:
		- Forwarding Information Base (FIB)
		- Adjacency Base | Adjacency Information Base (AIB)
- **Hardware CEF**
	- Components:
		- Application Specific IC (ASIC)
		- Network Processing Unit (NPU)

>[!faq] Note
>**Ternary Content Addressable Memory (TCAM)**
>- it is an extension of CAM architecture that is enhanced to allow upper-layer processing such as identifying the Layer 2/3 addresses, protocols, QoS markings, etc.

#### Switching Database Manager (SDM)
- **SDM Templates**
	`- switching database manager.`
	`- it used to modify resources (eg. RAM, CPU, etc.) on how much to allocate for switching/routing mechanism, such as Routing Table, MAC Table, processing frame/packet, etc.`
	- **Types:**
		- VLAN
		- Advanced

	![](https://i.imgur.com/jjgYp9A.png)


[[#Table of Contents|back to top]]
<hr>

## Spanning-Tree Protocol (STP)
`- a layer 2 protocol that enables switches to become aware of other switches through the advertisement and receipt of Bridge Protocol Data Unit (BPDU).`

### STP Foundation

- **Sample STP Election**
	![](https://i.imgur.com/kSz7orP.png)

- **Sample RSTP Election**
	![](https://i.imgur.com/KnnaCVn.png)

- **STP Iteration:**

|    Protocol     | Proprietary | Spanning-Tree Calculation |
| :-------------: | :---------: | :-----------------------: |
|     **STP**     | IEEE 802.1D |         All VLANs         |
|    **PVST+**    |    Cisco    |         Per VLAN          |
|    **RSTP**     | IEEE 802.1W |         All VLANs         |
| **Rapid PVST+** |    Cisco    |         Per VLANs         |
|    **MSTP**     | IEEE 802.1S |       Per Instance        |

#### Bridge ID Structure
- **Bridge ID**
	1. Bridge Priority
		- Bridge Priority
		- Extended System ID (VLAN ID)
	2. MAC Address
	   
![](https://i.imgur.com/zGsuwsR.png)

>[!faq] Note
>**Bridge Priority** = **Bridge Priority (default: 32768 or system priority 4-bits: 1000)** + **Extended System ID (VLAN ID)**

#### STP Key Terminology
>[!tip] Info
>**Root Bridge**
>- a switch that has been elected as a root.
>
>**Bridge Protocol Data Unit (BPDU)**
>- a packet that is used for network switches to process STP.
>
>**BPDU Types:**
>1. Configuration BPDU
>2. Topology Change Notification (TCN) BPDU
>
>**Root Path Cost**
>- a metric used for measuring the path to the root bridge.
>
>**System Priority**
>- a 4-bit value that indicates the hierarchy of switch in the STP topology (default value is 32768).
>- the lowest value is elected as root (value between 0-61440, increments of 4096).
>
>**System ID Extension**
>- a 12-bit value indicates the VLAN that the BPDU correlates to.
>
>**Root Bridge ID**
>- details of the switch that has been elected as a root.
>
>**Local Bridge ID**
>- details of the switch that you are managing currently.
>

#### Root Bridge Election Process
1. Lowest ***Bridge Priority***.
2. Lowest ***MAC Address***.

#### Designated Port Election Process
1. Lowest ***Root Cost***.
2. Lowest ***Neighbor Bridge ID***.
3. Lowest ***Port Priority***
4. Lowest ***Port Number***

>[!faq] Note
>- An interface that is connected to a **designated port**, if it is not a **root port**, will become a **blocking port**.

#### STP Timers

>[!tip] KeyTerms
> **Hello Timer**
>- time interval that BPDU is being advertised (default value is ***2 seconds***).
>
>**Max Age**
>- maximum time that a bridge port saves the BPDU information.
>- **802.1D (STP) = default value is 10 × Hello Timer = 20 seconds
>- **802.1W (RSTP)** = default value is 6 seconds
>
>**Forward Delay**
>- amount of time that a ports stays in a ***listening*** and ***learning*** state (default value is ***15 seconds each state***).
>  
>**STP Convergence Time (Approx.)**
>- around **50 seconds** = 30s (Forward Delay) + 20s (Time that the switch needs to realize the link is up/down)


#### STP Link Costs
![](https://i.imgur.com/43qMNMi.png)


>[!faq] Note
> **Link Cost:**
> - is a numeric value that represents the cost of speed of a link.
>
>**Path Cost:**
>- is the calculation of all of the link costs that leads back to the root bridge and the value that is used to elect root port on a switch.


#### STP Topology Change
>[!example] STP process when topology change
>1. Switch that detects a link status change sends a **Topology Change Notification (TCN)** towards the **Root Bridge**.
>2. **Root Bridge** creates a new **BPDU configuration** with the **Topology Change Flag** set, and floods it to all switches.
>3. Switches that receives a new **BPDU configuration** will put itself in a **Learning** state (15s forwarding timer), and **flushes out MAC addresses** in its MAC Table.


### 802.1D STP Fundamentals

#### 802.1D Port States
- **Disable**
- **Blocking**: 20 seconds
- **Listening**: 15 seconds
- **Learning**: 15 seconds
- **Forwarding**
- **Disable/Broken**
	![](https://i.imgur.com/84X4Q7G.png)

#### 802.1D Port Roles

| **Port Roles**           | Definition                                                                       |
| ------------------------ | -------------------------------------------------------------------------------- |
| **Root Port (RP)**       | A port on a switch that is the closest way (Lowest Cost) to the Root Bridge.     |
| **Designated Port (DP)** | A port that can send the best BPDU on its segment. (Forwarding traffic.)         |
| **Blocking Port**        | A blocking port that receives BPDU from another switch. (Not forwarding traffic) |
#### 802.1D Port Types

| **Port Types**           | Definition                                                                |
| ------------------------ | ------------------------------------------------------------------------- |
| **Point-to-point (P2P)** | A port that is connected with another network device (PC or RSTP switch). |
| **P2P edge**             | A port that is enabled as a portfast.                                     |

### 802.1W RSTP Fundamentals
#### 802.1W Port States
- **Discarding** `- combinination of Disable, Blocking and Listening state of 802.1D.`
- **Learning**
- **Forwarding**
	![](https://i.imgur.com/FAhEkDs.png)

#### 802.1W Port Roles

| **Port Roles**           | Definition                                                                                         |
| ------------------------ | -------------------------------------------------------------------------------------------------- |
| **Root Port (RP)**       | A port on a switch that is the closest way (Lowest Cost) to the Root Bridge.                       |
| **Designated Port (DP)** | A port that can send the best BPDU on its segment.                                                 |
| **Alternate Port**       | A blocking port that receives better BPDU from another switch. It is a backup of Root Port.        |
| **Backup Port**          | A blocking port that receives better BPDU from the same switch. It is a backup of Designated Port. |

![](https://i.imgur.com/0snjhf7.png)

#### 802.1W Port Types

| **Port Types**          | Definition                                                                                                                             |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| **Edge Port**           | A port at the edge of the network where hosts connect to the Layer 2 topology. It correlates to a port that have the portfast enabled. |
| **Non-Edge Port**       | A port that has received a BPDU.                                                                                                       |
| **Point-to-point port** | A port that connects to another RSTP enabled switch with full duplex.                                                                  |
>[!faq] Note
>- **RSPT (802.1W)** will work only on **full duplex** setup. If the port is in a **half duplex**, the operation will operate under **STP (802.1D)**. 


[[#Table of Contents|back to top]]
<hr>

## Multiple Spanning Tree (MST)
`- it is an STP that solves the problem of BPDU advertisement overload on each VLAN STP instances (PVST) on a large enterprise network.`
`- it is seperate STP instances for each VLAN.`

### MST Fundamentals (802.1S)
#### MST Region
`- grouping multiple switch as a single virtual switch (much like similar to BGP autonomous system).`
- **How to group multiple switch on specific MST Region?**
	- The same MST configuration name.
	- The same MST revision number.
	- The same VLAN mapping table.

![](https://i.imgur.com/EHQiZ2N.png)

#### MST Teminologies
![](https://i.imgur.com/GTW1gAL.png)

- **MST Instances (MSTI)**
	`- a group of multiple VLANs to advertise only one BPDU per MST instances rather than per VLAN.`
	`- instance value range 1-15.`

- **Internal Spanning Tree (IST)**
	`- a VLAN that is not not assigned to an MSTI.`
	`- instance value of 0 (default instance value).`

- **Common Spanning Tree (CST)**
	`- a mechanism that is used to advertise instantances on switches from other MST regions.`

- **Common Internal Spanning Tree (CIST)**
	`- collection of ISTs in each of MST regions.`

>[!warning] Note
>Assigning multiple VLANs should be avoided on an IST.

[[#Table of Contents|back to top]]
<hr>

## VLAN Trunks and EtherChannel Bundles
![[Cisco CCNA#VLAN Trunks and EtherChannel Bundles]]

[[#Table of Contents|back to top]]
<hr>

## IP Routing Essentials
### Routing Protocol Overview
#### Metric Calculation Algorithms
- **Distance Vector**
- **Link-State**
- **Enhanced Distance Vector**
- **Path Vector**
#### Common Dynamic Routing Protocols
- **Routing Information Protocol Version 2 (RIPv2)**
- **Enhanced Interior Gateway Routing (EIGRP)**
- **Open Shortest Path First (OSPF)** 
- **Intermediate System-to-Intermediate System (IS-IS)**
- **Border Gateway Protocol (BGP)** 

| Protocol | Metric Calculation Algorithm |
| :------: | :--------------------------: |
|  RIPv2   |       Distance Vector        |
|  EIGRP   |   Enhanced Distance Vector   |
|   OSPF   |          Link-State          |
|  IS-IS   |          Link-State          |
|   BGP    |         Path Vector          |

### Path Selection
#### Path Selection Rules
1. **Longest Prefix Length Match**
2. **Administrative Distance**
3. **Metrics**

#### Default Administrative Distance
![](https://i.imgur.com/2SVVgT4.png)


#### Metrics
- **Equal-Cost Multipathing (ECMP)**
	`- if there are multiple path to the destination and have the same metrics, it performs load-balancing to send packets to the destination.`
- **Unequal-Cost Load Balancing**
	`- additional EIGRP feature which allows load-balancing even if multiple paths have unequal metrics to the destination.`
	
### Static Routing
#### Types of Static Routing Configuration
- **Directly attached static route**
	- Source: *network-IP-address*
	- Destination: *interface-address*
- **Recursive static route**
	- Source: *network-IP-address*
	- Destination: *network-IP-address*
- **Fully specified static route**
	- Source: *network-IP-address*
	- Destination: *interface-address* and *network-IP-address*

#### Floating Static Routing
`- a static routing configuration to one destination with multiple paths using different administrative distance.`

### Virtual Routing and Forwarding (VRF)
` a technology that creates multiple virtual routers on a single physical router.`

![](https://i.imgur.com/GPLxTyb.png)

[[#Table of Contents|back to top]]
<hr>


## Enhanced Gateway Routing Protocol (EIGRP)
### EIGRP Fundamentals

|       Term       |                Info                 |
| :--------------: | :---------------------------------: |
| Protocol Number  |                 88                  |
|       Type       |       advance distance vector       |
|      Metric      | bandwidth, load, delay, reliability |
| Path Calculation |  Diffusing Update Algorithm (DUAL)  |
|  Max Hop Count   |                 255                 |
- **Multicast Address:**
	- IPv4: 224.0.0.10
	- MAC: 01-00-5E-00-00-0A


#### EIGRP Features
- **Rapid convergence**
	`- because it also calculates a feasible successor in case of failure in the current successor route.`
- **Load Balancing**
	- Equal-Cost Multipathing (ECMP)
	- Unequal-Metric Load Balancing
- **Multi-address family support**
- **Reduced bandwidth use**

#### EIGRP Terminology
![](https://i.imgur.com/Oex7B8k.png)
![](https://i.imgur.com/vpeLiEa.png)

#### EIGRP Packet Types
- **Hello**
	- Hello Timer: 5 seconds
	- Hold Timer: 3x (15 seconds)
- **Acknowledge**
	![](https://i.imgur.com/Zx70R0C.png)

### EIGRP Path Metric Calculation
- **EIGRP Metric**

| K-Value |                Metric                |
| :-----: | :----------------------------------: |
|   K1    |              Bandwidth               |
|   K2    |                 Load                 |
|   K3    |                Delay                 |
| K4, K5  |             Reliability              |
|   K6    | Extended Attributes (jitter, energy) |


- **EIGRP Path Metric Calculation Formula**
		![](https://i.imgur.com/QJrXiHP.png)
- **EIGRP Path Wide Metric Calculation Formula**
		![](https://i.imgur.com/cMovaae.png)

- **EIGRP Attribute Propagation Example**
		![](https://i.imgur.com/tudMXCy.png)
- **EIGRP Interface Metrics**
		![](https://i.imgur.com/VjshONi.png)

[[#Table of Contents|back to top]]
<hr>

## Open Short Path First (OSPF)
### OSPF Fundamentals
|       Term       |             Info             |
| :--------------: | :--------------------------: |
| Protocol Number  |              89              |
|       Type       |          link-state          |
|      Metric      |             cost             |
| Path Calculation | Dijkstra Shortest Path First |
|  Max Hop Count   |              NA              |

#### OSPFv2 vs OSPFv3
|    Feature     |  OSPFv2   |    OSPFv3     |
| :------------: | :-------: | :-----------: |
|   IP Version   |   IPv4    | IPv4 and IPv6 |
|   Router-ID    | Automatic |    Manual     |
|   LSA Types    |     9     |      11       |
| Authentication |    MD5    | MD5 and IPsec |
- **Multicast Address:**
	- **AllSPFRouters:**
		- IPv4: 224.0.0.5
		- IPv6: FF02::5
		- MAC: 01-00-5E-00-00-05
	- **AllDRouters:**
		- IPv4: 224.0.0.6
		- IPv6: FF02::6
		- MAC: 01-00-5E-00-00-06
	
	![](https://i.imgur.com/zk4jwXo.png)


#### OSPF Area Design Structure (Sample)
![](https://i.imgur.com/1XmOW1l.png)


#### OSPF Data Structures or Database
![](https://i.imgur.com/YYzX5FO.png)


#### OSPF Link-State Operation
- **Steps on How OSPF Established Link-State:**
	1. **Establish Neighbor Adjacencies**
	2. **Exchange Link-State Advertisements**
	3. **Build the Link State Database (LSDB)**
	4. **Execute the SPF Algorithm**
	5. **Choose the Best Route**


#### OSPF Packet Types
![](https://i.imgur.com/l6IRWpt.png)

#### OSPF Packet Header Fields
![](https://i.imgur.com/zLm2pr2.png)
![](https://i.imgur.com/Xigy1EC.png)

>[!faq] Note
>**Hello Packet:**
>- Hello Timer: 10 seconds
>- Dead Interval Timer: 4x (40 seconds) 
>
>**Router Interface Assignment:**
>1. Designated Router (DR)
>2. Backup Designated Router (BDR)
>3. DROther
>
>**DR Election:**
>1. Highest Interface Priority (Default Priority = 1)
>2. Highest OSPF Router-ID
>
>**Election of Router-ID (If not explicitly configured)**
>1. Highest IPv4 address of any of configured loopback interfaces.
>2. Highest IPv4 address of any of active physical interfaces.

#### OSPF Neighbor States
![](https://i.imgur.com/Dv5VaGW.png)


- **OSPF Multiaccess Network Neighbor State:**
	- FULL/DROTHER
	- FULL/DR
	- FULL/BDR
	- 2-WAY/DROTHER
	  
>[!faq] Note
>**ExStart State Master/Slave Election**
>- Highest RID = Master
>- Lowest RID = Slave
>
>**OSPF Parameters that should match to establish Neighbor Relationship:**
>- Area ID
>- Authentication
>- Hello and Dead intervals
>- Stub Flag
>- MTU Size

#### OSPF Network Types | Network Setup
![](https://i.imgur.com/zvLZM74.png)

>[!faq] Note
>**Default OSPF Network Type for specific interface connection:**
>- Ethernet Link = Broadcast
>- HDLC/PPP on Serial Link = Point-to-Point

### Advanced OSPF 
#### OSPF LSA Types
| Type |       Name        |                              Definition                              |
|:----:|:-----------------:|:--------------------------------------------------------------------:|
|  1   |    Router LSA     |       router advertises the LSA to directly connected devices.       |
|  2   |    Network LSA    | generated by elected DR to neighboring routers within the same area. |
|  3   |    Summary LSA    |            an LSA that originated from a different area.             |
|  4   | Summary ASBR LSA  |                advertises a summary LSA from an ASBR.                |
|  5   |  AS external LSA  |  advertises an LSA from different AS that is generated by an ASBR.   |
|  7   | NSSA external LSA |              advertises redistributed routes in NSSAs.               |
>[!faq] Note
>These LSA Types are what contains in a **LSU Packet**.

#### OSPF Cost Calculation
![500](https://i.imgur.com/vs34qx2.png)
>[!faq] Note
>Default ***Reference Bandwidth*** = ***100 Mbps*** = **100000000**

#### OSPF Equal-Cost Routes
- **Default:** 4 routes
- **Maximum:** 32 routes


[[#Table of Contents|back to top]]
<hr>


## Border Gateway Protocol (BGP)
### BGP Fundamentals 
- **Autonomous System**
	`- a collection of routers within a single organization's control which may used one or more IGPs.`

#### Autonomous System Number (ASN)
	`- a 4-bytes field (32-bit) that allows 4,294,967,295 unique ASNs.`
- **Two Blocks of ASN:**
	- **Private ASN:** 64,512 to 65,535
	- **Public ASN:** `- numbers aside from private.`
- **Default Timers**
	- **Keep Alive:** 60 seconds
	- **Hold Timer:** 180 seconds


#### BGP Sessions 
- **Internal BGP (iBGP)**
	`- routers that participates in the same AS.`
- **External BGP (eBGP)**
	`- routers that are in a different AS.`


### BGP DeepDive
#### BGP Path Attributes
`a conditions that bgp checks on which AS should a packet routed on the network.`

|           Attributes           |                                       Information                                        |
| :----------------------------: | :--------------------------------------------------------------------------------------: |
|             Weight             |                              a Cisco proprietary attribute.                              |
|        Local Preference        |                 commonly used to influence the out-bound path selection.                 |
|           Originate            |                            the source of path it originates.                             |
|         AS Path Length         |           the number of AS it goes through in order to reach the destination.            |
|          Origin Type           |              how the route gets into BGP table, such as (i) or (e) or (?).               |
| Multi-Exit Discriminator (MED) | a value that is advertised by neighboring BGP routers that influence the path selection. |
|             Paths              |                           about a eBGP is preferred over iBGP.                           |
|           Router ID            |                             the configure router-id itself.                              |

#### iBGP solutions
- **BGP Confederation**
	`- creating a sub-AS under one AS.`
- **BGP Route Reflector**
	`- it somewhat electing a designated router to associate BGP neighborship.`

#### BGP Neighbor Formation and States
- **Idle**
- **Connect**
- **Active**
- **Open Sent**
- **Open Confirm**
- **Established**

>[!note] Note
>	Connect and Active states are done through a TCP Three-Way Handshake process.


[[#Table of Contents|back to top]]
<hr>

## First Hop Redundancy Protocol (FHRP)
`- it creates a virtual router on multiple routers that will act as a default gateway to the hosts belong to the network.`
`- alongside with its virtual router, it also creates an virtual IP address and virtual MAC address.`
`- it sends a multicast HELLO messages to maintain FHRP to other routers.`

- **3 Redundancy Protocols**
	- Hot Standby Router Protocol (HSRP)
	- Virtual Router Redundancy Protocol (VRRP)
	- Gateway Load Balancing Protocol (GLBP)

### Hot Standby Router Protocol (HSRP)
[[Cisco CLI Commands#Hot Standby Router Protocol (HSRP) |HSRP Configuration]]
`- Cisco proprietary.`

#### Virtual MAC Address
![](https://i.imgur.com/us2WYzW.png)

- **Vendor ID** `- dictates the vendor of the device or OUI.`
- **HSRP ID** `- dictates it is HSRP Protocol (07.AC)`.
- **Group ID** `- dictate what hsrp group it belongs. In the figure, the group number is 10 (dec) equivalent to 0A (hex)`.

#### HSRP Timers
- **Hello Timer** 
`- default interval is 3 seconds.`
- **Hold Timer** 
`- default hold timer is 10 seconds (approx 3x of Hello Timer).`
- **Active Timer**
`- used to monitor the state of Active router.`
- **Standby Timer**
`- used to monitor the state of the Standby router.`

#### HSRP Roles
- **Virtual Router**
- **Active Router**
- **Standby Router**
- **Other Routers**

#### HSRP States
- **Initial (INIT)**
- **Learn**
- **Listen**
- **Speak**
- **Standby**
- **Active**
#### HSRP Troubleshooting
- Different HSRP virtual IP addresses configured on the peers.
- Different HSRP groups are configured on the peers.
- Different HSRP versions are configured on the peers or ports blocked.
#### HSRP Multicast Address
- **Version 1**
	- IP Add: 224.0.0.2
	- UDP Port: 1985
- **Version 2**
	- IP Add: 224.0.0.102
	- UDP Port: 1985

### Virtual Router Redundancy Protocol (VRRP)
[[Cisco CLI Commands#Virtual Router Redundancy Protocol (VRRP)|VRRP Configuration]]
`- IETF standard.`
#### VRRP MAC Address
- **00-00-5E-00-01-XX**
	`- the XX is the group number of the vrrp.`
#### VRRP Timers
- **Hello Timer**: 
	`- 1 second (defualt timer)`
- **Hold Timer**: 
	`- 3 seconds (default timer)`
#### VRRP Roles
- **Master Router**
- **Backup Router**

### Gateway Load Balancing Protocol (GLBP)
[[Cisco CLI Commands#Gateway Load Balancing Protocol (GLBP)|GLBP Configuration]]
`- Cisco proprietary.`
`- it works using host-dependent/round-robin/weighted method to assign different mac-to-ip address mapping to the end hosts that are getting an ARP request so that each hosts will forward packets on different routers on the GLBP group.`
#### GLBP MAC Address
- **Many Virtual MAC Address.**
#### GLBP Role
- **Active**
- **Standby**
#### GLBP Parts
- **Active Virtual Gateway (AVG)**
	`- only one (1) router is assigned as an AVG.`
- **Active Virtual Forwarder (AVF)**
	`- the number of AVFs will depend to the number of router associated on the GLBP group. `
#### GLBP Timers
- **Hello Timer** 
`- default interval is 3 seconds.`
- **Hold Timer** 
`- default hold timer is 10 seconds (approx 3x of Hello Timer).`
#### GLBP Load Balancing Methods
- **Host-dependent**
- **Round-robin**
- **Weighted**


[[#Table of Contents|back to top]]
<hr>


## Network Address Translation (NAT)
### NAT Terms Topology
|     Terms      |                        Definition                        |
|:--------------:|:--------------------------------------------------------:|
|  Inside Local  |     refers to private addresses inside your network.     |
| Inside Global  |    refers to public address assigned on your network.    |
| Outside Global | refers to public address assigned on the remote network. |
| Outside Local  |    refers to private addresses on the remote network.    | 

![](https://i.imgur.com/GMKnhsn.png)

### Types of NAT
|    Type     |                                           Definition                                            |
|:-----------:|:-----------------------------------------------------------------------------------------------:|
| Static NAT  |        refers to static one-to-one translation of local IP address to global IP address         |
| Pooled NAT  | refers to dynamic one-to-one translation with multiple number of global IP addresses available. |
| Single PAT  |          refers to dynamic many-to-one translation through port-to-ip address mapping.          |
| Dynamic PAT | refers to dynamic many-to-one translation but multiple number of global IP addresses available. | 


[[#Table of Contents|back to top]]
<hr>

## Overlay Tunnels
- **Encapsulation Over**

### GRE Tunnel
#### GRE Header
- **Characteristics of GRE**
	- Layer 3 protocol. 
	- Stateless and has no flow control.
	- No security.
	- Adds an overhead of at least 24 bytes.
	![](https://i.imgur.com/ZLBea7h.png)
	![](https://i.imgur.com/PxpO5Zp.png)

#### Encapsulation Overhead for Tunnels
![](https://i.imgur.com/LDljMXJ.png)

#### Common Problems with Overlay Network
- **Recursive Routing**
	`- occurs when the internet facing ip address (public address) is added to the IGP dynamic routing (RIP, OSPF, EIGRP) "network" command.`

>[!faq] Note
> **GRE** is a **Cisco Proprietary**.

### IPsec Tunnel
- **IPsec Security Services Offers**
	- Peer Authentication
	- Data Confidentiality
	- Data Integrity
	- Replay Detection

#### Types of IPsec Packet Headers

|  | **Authentication Header (AH)** | **Encapsulating Security Payload (ESP)** |
| :--: | :--: | :--: |
| Data Integrity | **✓** | **✓** |
| Authentication | **✓** | **✓** |
| Replay Packet Protection | **✓** | **✓** |
| Encryption |  | **✓** |
| NAT Traversal (NAT-T) |  | **✓** |
| Protocol Number | 51 | 50 |

- **IPsec ESP Modes:**
	- **Transport Mode**
		`- only the payload is encrypted.`
	- **Tunnel Mode**
		`- encrypts the entire packet.`
		![](https://i.imgur.com/HrFtK1F.png)

#### IPsec Security Methods
- **Encryption:**
	1. Data Encryption Standard (DES)
	2. Triple DES (3DES)
	3. Advanced Encryption Standard (AES)
- **Hashing:**
	1. Message Digest 5 (MD5)
	2. Secure Hash Algorithm (SHA)
- **Keying**
	1. Diffie-Hellman (DH)
	2. RSA signatures
	3. Pre-Shared Key

#### IPsec Transform Sets
`- is a combination of security protocols and algorithms.`
- **Authentication Header (AH)**
		![](https://i.imgur.com/d1lSoJ8.png)
- **Encapsulating Security Payload (ESP)**
		![](https://i.imgur.com/B9fYkuD.png)

#### IPsec Framework
`- components and its ingredients that are needed to create an IPsec.`
![](https://i.imgur.com/Zz9xUZI.png)

#### Internet Key Exchange (IKE)
`- is a protocol that performs authentication between two end-points to establish security associations (SAs), also known as IKE tunnels.`

- **IKE Versions**
	1. **IKEv1**
		`- based on RFC 2409.`
		- Phase-1:
			1. Main mode
				`- 6 message exchange.`
			2. Aggressive mode
				`- 3 message exchange.`
		- Phase-2:
			1. Quick Mode
				`- 3 message exchange.`
	2.  **IKEv2**
		`- based on RFC 7296.`
		- Phase-1:
			1. IKE_Init (SA_INIT)
		- Phase-2:
			1. IKE_Auth
			2. Child_SA
- **IKEv1 vs IKEv2**
	![](https://i.imgur.com/eE9ngFJ.png)

#### IPsec VNP Solutions
- **Cisco IPsec VPN Solutions**
		![](https://i.imgur.com/AF0M69A.png)

#### IPsec Site-to-Site VPN
- **GRE over IPsec VS VTI over IPsec**
		![](https://i.imgur.com/3hZHbKZ.png)

### Location ID Separation Protocol (LISP)
#### LISP Addressed Issues
- Aggregation issues
- Traffic engineering
- Multihoming
- Routing instability

#### LISP Architecture Reference Topology

|            Terms            |                                 Definition                                 |
|:---------------------------:|:--------------------------------------------------------------------------:|
| Endpoint indentifier (EID)  |            is the IP address of an endpoint within a LISP site.            |
|          LISP site          |                 a site where LISP routers and EIDs reside.                 |
| Ingress tunnel router (ITR) |     a LISP routers that LISP-encapsulate IP packets coming from EIDs.      |
| Egress tunnel router (ETR)  |      a LISP routers that de-encapsulate LISP-encapsulated IP packets.      |
|     Tunnel router (xTR)     |                routers that perform ITR and ETR functions.                 |
|      Proxy ITR (PITR)       |                  similar to ITRs but for non-LISP sites.                   |
|      Proxy ETR (PETR)       |                  similar to ETRs but for non-LISP sites.                   |
|      Proxy xTR (PxTR)       |         refers to a router that performs PITR and PETR functions.          |
|         LISP router         |           a router that performs either ITR, ETR, PITR, or PETR.           |
|   Routing Locator (RLOC)    |       is an IPv4 or IPv6 address of an ETR that is Internet facing.        |
|       Map Server (MS)       |        a network device that learns EID-to-prefix mapping entries.         |
|      Map Resolver (MR)      | a network device that receives LISP-encapsulated map requests from an ITR. |
|            MS/MR            |               a network device that performs both MS and MR.               |
|                             |                                                                            |

![](https://i.imgur.com/qw2Sjfx.png)

#### LISP Main Components
- **LISP Routing Architecture**
- **LISP Control Plane Protocol**
	![](https://i.imgur.com/shBczCI.png)

- **LISP Data Plane Protocol**
	- **Port Number**: UDP 4341
	![](https://i.imgur.com/pU9YpxU.png)


### Virtual Extensible Local Area Network (VXLAN)
- **VXLAN Packet Format**
	- **Port Number:** UDP 4789
	![](https://i.imgur.com/94dac9i.png)

- **VXLAN vs VLAN**
	- **VXLAN:** 24-bit VXLAN network identifier (VNI) (VXLAN equal to 16million VXLANs)
	- **VLAN:** 12-bit (equal to 4000 VLANs)

- **Virtual Tunnel Endpoint (VTEP)**
	`- entries that originate or terminate VXLAN tunnels.`
	 - **Components:**
		 - Local LAN interface
		 - IP interface
		![](https://i.imgur.com/8t5RaC8.png)



[[#Table of Contents|back to top]]
<hr>
